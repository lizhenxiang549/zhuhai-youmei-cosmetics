# Ubuntu 22.04 ä¿®æ­£ç‰ˆéƒ¨ç½²è„šæœ¬ä½¿ç”¨æŒ‡å—

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### ç¬¬ä¸€æ­¥ï¼šä¸‹è½½è„šæœ¬
```bash
# æ–¹æ³•1: ç›´æ¥ä¸‹è½½è„šæœ¬æ–‡ä»¶
wget https://raw.githubusercontent.com/your-repo/Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh
chmod +x Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh

# æ–¹æ³•2: å…‹éš†æ•´ä¸ªé¡¹ç›®
git clone https://github.com/your-username/zhuhai-youmei-deploy.git
cd zhuhai-youmei-deploy
chmod +x .same/Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh
```

### ç¬¬äºŒæ­¥ï¼šè¿è¡Œè„šæœ¬
```bash
# æ‰§è¡Œå®Œæ•´éƒ¨ç½²
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh

# æˆ–è€…å…ˆæ£€æŸ¥ç³»ç»Ÿç¯å¢ƒ
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh check
```

### ç¬¬ä¸‰æ­¥ï¼šæŒ‰æç¤ºè¾“å…¥é…ç½®
è„šæœ¬ä¼šå¼•å¯¼æ‚¨è¾“å…¥å¿…è¦çš„é…ç½®ä¿¡æ¯ï¼š

```bash
è¯·è¾“å…¥åŸŸå (ä¾‹å¦‚: example.comï¼Œç•™ç©ºä½¿ç”¨IP):
è¯·è¾“å…¥ç®¡ç†å‘˜é‚®ç®± (ç”¨äºSSLè¯ä¹¦):
è¯·è®¾ç½®æ•°æ®åº“å¯†ç  (è‡³å°‘8ä½):
è¯·è®¾ç½®Rediså¯†ç  (è‡³å°‘8ä½):
è¯·è®¾ç½®Djangoç®¡ç†å‘˜å¯†ç  (è‡³å°‘8ä½):
```

---

## ğŸ“‹ é…ç½®ä¿¡æ¯è¯¦è§£

### ğŸŒ åŸŸåé…ç½®
```bash
# ç¤ºä¾‹1: ä½¿ç”¨åŸŸå
è¯·è¾“å…¥åŸŸå: youmei.com

# ç¤ºä¾‹2: ä½¿ç”¨IPåœ°å€ï¼ˆç•™ç©ºè‡ªåŠ¨è·å–ï¼‰
è¯·è¾“å…¥åŸŸå: [ç›´æ¥å›è½¦ï¼Œè‡ªåŠ¨ä½¿ç”¨æœåŠ¡å™¨IP]
```

**è¯´æ˜ï¼š**
- å¦‚æœæœ‰åŸŸåï¼Œè¾“å…¥å®Œæ•´åŸŸåï¼ˆä¸å«http://ï¼‰
- å¦‚æœæ²¡æœ‰åŸŸåï¼Œç›´æ¥å›è½¦ä½¿ç”¨æœåŠ¡å™¨IP
- åŸŸåå°†ç”¨äºSSLè¯ä¹¦ç”³è¯·å’ŒNginxé…ç½®

### ğŸ“§ é‚®ç®±é…ç½®
```bash
# ç¤ºä¾‹
è¯·è¾“å…¥ç®¡ç†å‘˜é‚®ç®±: admin@youmei.com
```

**è¯´æ˜ï¼š**
- ç”¨äºSSLè¯ä¹¦ç”³è¯·
- ç”¨äºDjangoè¶…çº§ç”¨æˆ·è´¦å·
- å»ºè®®ä½¿ç”¨çœŸå®é‚®ç®±åœ°å€

### ğŸ” å¯†ç é…ç½®
```bash
# æ•°æ®åº“å¯†ç ç¤ºä¾‹
è¯·è®¾ç½®æ•°æ®åº“å¯†ç : MySecureDb123!

# Rediså¯†ç ç¤ºä¾‹
è¯·è®¾ç½®Rediså¯†ç : MySecureRedis456!

# Djangoç®¡ç†å‘˜å¯†ç ç¤ºä¾‹
è¯·è®¾ç½®Djangoç®¡ç†å‘˜å¯†ç : MySecureAdmin789!
```

**å¯†ç è¦æ±‚ï¼š**
- è‡³å°‘8ä½å­—ç¬¦
- å»ºè®®åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
- é¿å…ä½¿ç”¨ç®€å•å¯†ç å¦‚"password"ã€"123456"

---

## ğŸ”§ è„šæœ¬æ‰§è¡Œé€‰é¡¹

### å®Œæ•´éƒ¨ç½²
```bash
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh deploy
# æˆ–ç›´æ¥è¿è¡Œ
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh
```

### ç³»ç»Ÿæ£€æŸ¥
```bash
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh check
```
æ£€æŸ¥å†…å®¹ï¼š
- Ubuntuç‰ˆæœ¬éªŒè¯
- å†…å­˜å’Œç£ç›˜ç©ºé—´æ£€æŸ¥
- ç”¨æˆ·æƒé™éªŒè¯

### ç³»ç»Ÿæ›´æ–°
```bash
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh update
```
ä»…æ‰§è¡Œç³»ç»ŸåŒ…æ›´æ–°ï¼Œä¸è¿›è¡Œéƒ¨ç½²ã€‚

### éƒ¨ç½²éªŒè¯
```bash
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh verify
```
éªŒè¯å·²éƒ¨ç½²çš„æœåŠ¡çŠ¶æ€ã€‚

---

## â±ï¸ éƒ¨ç½²æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | é¢„è®¡æ—¶é—´ | è¯´æ˜ |
|------|----------|------|
| ç³»ç»Ÿæ£€æŸ¥ | 1åˆ†é’Ÿ | éªŒè¯ç¯å¢ƒå’Œæ”¶é›†é…ç½® |
| ç³»ç»Ÿæ›´æ–° | 3-5åˆ†é’Ÿ | æ›´æ–°UbuntuåŒ… |
| è½¯ä»¶å®‰è£… | 5-10åˆ†é’Ÿ | Node.js, Python, PostgreSQLç­‰ |
| é¡¹ç›®éƒ¨ç½² | 3-5åˆ†é’Ÿ | Djangoåç«¯å’ŒVueå‰ç«¯ |
| æœåŠ¡é…ç½® | 2-3åˆ†é’Ÿ | Nginx, Supervisor, SSL |
| **æ€»è®¡** | **15-25åˆ†é’Ÿ** | å–å†³äºç½‘ç»œé€Ÿåº¦ |

---

## ğŸ“ éƒ¨ç½²ç»“æœ

### ç›®å½•ç»“æ„
```
/var/www/zhuhai-youmei/
â””â”€â”€ ym-cosmetics/                 # é¡¹ç›®æ ¹ç›®å½•
    â”œâ”€â”€ backend/                  # Djangoåç«¯
    â”‚   â”œâ”€â”€ zhuhai_youmei/       # Djangoé¡¹ç›®
    â”‚   â”œâ”€â”€ venv/                # Pythonè™šæ‹Ÿç¯å¢ƒ
    â”‚   â”œâ”€â”€ media/               # åª’ä½“æ–‡ä»¶
    â”‚   â”œâ”€â”€ staticfiles/         # é™æ€æ–‡ä»¶
    â”‚   â””â”€â”€ .env                 # ç¯å¢ƒé…ç½®
    â”œâ”€â”€ frontend/                 # Vueå‰ç«¯
    â”‚   â”œâ”€â”€ src/                 # æºä»£ç 
    â”‚   â”œâ”€â”€ dist/                # æ„å»ºè¾“å‡º
    â”‚   â””â”€â”€ package.json         # ä¾èµ–é…ç½®
    â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
    â”œâ”€â”€ backups/                  # å¤‡ä»½æ–‡ä»¶
    â””â”€â”€ scripts/                  # ç®¡ç†è„šæœ¬
```

### è®¿é—®åœ°å€
```bash
# å‰ç«¯ç½‘ç«™
https://youmei.com/

# ç®¡ç†åå°
https://youmei.com/api/admin/
ç”¨æˆ·å: admin
å¯†ç : [æ‚¨è®¾ç½®çš„ç®¡ç†å‘˜å¯†ç ]

# APIæ¥å£
https://youmei.com/api/
å¥åº·æ£€æŸ¥: https://youmei.com/api/health/
```

### æœåŠ¡ç«¯å£
```bash
# Nginx (å¯¹å¤–)
HTTP: 80
HTTPS: 443

# Django (å†…éƒ¨)
Gunicorn: 127.0.0.1:8000

# æ•°æ®åº“ (å†…éƒ¨)
PostgreSQL: 127.0.0.1:5432
Redis: 127.0.0.1:6379
```

---

## ğŸ› ï¸ éƒ¨ç½²åç®¡ç†

### å¸¸ç”¨ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
/var/www/zhuhai-youmei/ym-cosmetics/scripts/status.sh

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
/var/www/zhuhai-youmei/ym-cosmetics/scripts/logs.sh all

# æ›´æ–°éƒ¨ç½²
/var/www/zhuhai-youmei/ym-cosmetics/scripts/deploy.sh

# æ•°æ®å¤‡ä»½
/var/www/zhuhai-youmei/ym-cosmetics/scripts/backup.sh
```

### æœåŠ¡ç®¡ç†
```bash
# é‡å¯åç«¯æœåŠ¡
sudo supervisorctl restart zhuhai-youmei-backend

# é‡å¯WebæœåŠ¡å™¨
sudo systemctl restart nginx

# é‡å¯æ•°æ®åº“
sudo systemctl restart postgresql

# é‡å¯ç¼“å­˜
sudo systemctl restart redis-server
```

### Djangoç®¡ç†
```bash
# è¿›å…¥åç«¯ç›®å½•
cd /var/www/zhuhai-youmei/ym-cosmetics/backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# æ•°æ®åº“è¿ç§»
python3 manage.py migrate

# æ”¶é›†é™æ€æ–‡ä»¶
python3 manage.py collectstatic --noinput

# åˆ›å»ºè¶…çº§ç”¨æˆ·
python3 manage.py createsuperuser

# Django Shell
python3 manage.py shell
```

---

## ğŸš¨ æ•…éšœæ’é™¤

### 1. è„šæœ¬æƒé™é—®é¢˜
```bash
# é”™è¯¯: Permission denied
chmod +x Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh

# å¦‚æœä»æœ‰é—®é¢˜ï¼Œæ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
ls -la Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh
```

### 2. ç³»ç»Ÿæ£€æŸ¥å¤±è´¥
```bash
# å†…å­˜ä¸è¶³
free -h  # æ£€æŸ¥å†…å­˜
# å»ºè®®: å‡çº§æœåŠ¡å™¨é…ç½®æˆ–å…³é—­ä¸å¿…è¦æœåŠ¡

# ç£ç›˜ç©ºé—´ä¸è¶³
df -h    # æ£€æŸ¥ç£ç›˜
# å»ºè®®: æ¸…ç†ä¸´æ—¶æ–‡ä»¶æˆ–å‡çº§å­˜å‚¨
```

### 3. ç½‘ç»œè¿æ¥é—®é¢˜
```bash
# æµ‹è¯•ç½‘ç»œè¿æ¥
ping -c 3 google.com
curl -I https://deb.nodesource.com/

# å¦‚æœç½‘ç»œæœ‰é—®é¢˜ï¼Œæ£€æŸ¥é˜²ç«å¢™å’ŒDNS
```

### 4. è½¯ä»¶å®‰è£…å¤±è´¥
```bash
# æ‰‹åŠ¨æ›´æ–°è½¯ä»¶æº
sudo apt update
sudo apt upgrade -y

# æ¸…ç†APTç¼“å­˜
sudo apt clean
sudo apt autoremove

# é‡æ–°è¿è¡Œè„šæœ¬
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh
```

### 5. æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥åç«¯æœåŠ¡
sudo supervisorctl status zhuhai-youmei-backend
sudo supervisorctl tail -f zhuhai-youmei-backend

# æ£€æŸ¥Nginxé…ç½®
sudo nginx -t
sudo systemctl status nginx

# æ£€æŸ¥æ•°æ®åº“
sudo systemctl status postgresql
sudo -u postgres psql -l
```

### 6. SSLè¯ä¹¦ç”³è¯·å¤±è´¥
```bash
# æ£€æŸ¥åŸŸåè§£æ
nslookup youmei.com

# æ‰‹åŠ¨ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d youmei.com -d www.youmei.com

# æ£€æŸ¥é˜²ç«å¢™
sudo ufw status
```

---

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### å®šæœŸç»´æŠ¤ä»»åŠ¡

#### æ¯æ—¥
```bash
# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
/var/www/zhuhai-youmei/ym-cosmetics/scripts/status.sh

# æ£€æŸ¥æœåŠ¡æ—¥å¿—
/var/www/zhuhai-youmei/ym-cosmetics/scripts/logs.sh all
```

#### æ¯å‘¨
```bash
# ç³»ç»Ÿæ›´æ–°
sudo apt update && sudo apt upgrade -y

# æ•°æ®å¤‡ä»½
/var/www/zhuhai-youmei/ym-cosmetics/scripts/backup.sh

# æ¸…ç†æ—¥å¿—
sudo journalctl --vacuum-time=7d
```

#### æ¯æœˆ
```bash
# SSLè¯ä¹¦ç»­æœŸæ£€æŸ¥
sudo certbot certificates
sudo certbot renew --dry-run

# æ¸…ç†æ—§å¤‡ä»½
find /var/www/zhuhai-youmei/ym-cosmetics/backups/ -mtime +30 -delete

# æ•°æ®åº“ç»´æŠ¤
sudo -u postgres psql -d zhuhai_youmei -c "VACUUM ANALYZE;"
```

### ä»£ç æ›´æ–°æµç¨‹
```bash
# 1. å¤‡ä»½å½“å‰ç‰ˆæœ¬
/var/www/zhuhai-youmei/ym-cosmetics/scripts/backup.sh

# 2. æ›´æ–°ä»£ç  (å¦‚æœä½¿ç”¨Git)
cd /var/www/zhuhai-youmei/ym-cosmetics/backend
git pull origin main

cd /var/www/zhuhai-youmei/ym-cosmetics/frontend
git pull origin main

# 3. æ‰§è¡Œæ›´æ–°éƒ¨ç½²
/var/www/zhuhai-youmei/ym-cosmetics/scripts/deploy.sh

# 4. éªŒè¯æœåŠ¡çŠ¶æ€
/var/www/zhuhai-youmei/ym-cosmetics/scripts/status.sh
```

---

## ğŸ“ è·å–å¸®åŠ©

### æŸ¥çœ‹è„šæœ¬å¸®åŠ©
```bash
./Ubuntu22.04ä¸€é”®éƒ¨ç½²è„šæœ¬-ä¿®æ­£ç‰ˆ.sh --help
```

### å¸¸ç”¨è¯Šæ–­å‘½ä»¤
```bash
# ç³»ç»Ÿä¿¡æ¯
uname -a
lsb_release -a
free -h
df -h

# æœåŠ¡çŠ¶æ€
systemctl status nginx
systemctl status postgresql
systemctl status redis-server
supervisorctl status

# ç½‘ç»œçŠ¶æ€
netstat -tlnp | grep -E ':80|:443|:8000|:5432|:6379'
```

### æ—¥å¿—æ–‡ä»¶ä½ç½®
```bash
# åº”ç”¨æ—¥å¿—
/var/www/zhuhai-youmei/ym-cosmetics/logs/

# ç³»ç»Ÿæ—¥å¿—
/var/log/nginx/
/var/log/postgresql/
journalctl -u nginx
journalctl -u postgresql
```

---

ğŸ‰ **æ­å–œï¼æ‚¨å·²ç»æŒæ¡äº†ä¿®æ­£ç‰ˆéƒ¨ç½²è„šæœ¬çš„å®Œæ•´ä½¿ç”¨æ–¹æ³•ï¼**

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·å‚è€ƒæ•…éšœæ’é™¤éƒ¨åˆ†æˆ–æŸ¥çœ‹ç›¸å…³æ—¥å¿—æ–‡ä»¶ã€‚è„šæœ¬å·²ç»è¿‡ä¼˜åŒ–ï¼Œèƒ½å¤Ÿåœ¨å¤§å¤šæ•°Ubuntu 22.04ç¯å¢ƒä¸­ç¨³å®šè¿è¡Œã€‚
