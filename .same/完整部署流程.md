# ç æµ·ä¼˜ç¾å®˜ç½‘ - å®Œæ•´éƒ¨ç½²æµç¨‹æŒ‡å—

## ğŸ¯ éƒ¨ç½²æ¦‚è§ˆ

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å®Œæ•´éƒ¨ç½²ç æµ·ä¼˜ç¾åŒ–å¦†å“å®˜ç½‘ï¼ŒåŒ…æ‹¬Djangoåç«¯APIå’ŒVueå‰ç«¯åº”ç”¨çš„æ•´åˆéƒ¨ç½²ã€‚

### ç³»ç»Ÿæ¶æ„
```
ç”¨æˆ·è¯·æ±‚ â†’ Nginx â†’ Vueå‰ç«¯ (SPA)
          â†“
       Djangoåç«¯ (API) â†’ PostgreSQLæ•°æ®åº“
          â†“
       Redisç¼“å­˜ (å¯é€‰)
```

---

## ğŸ›’ 1. æœåŠ¡å™¨é€‰æ‹©æ–¹æ¡ˆ

### æ–¹æ¡ˆä¸€: å•æœåŠ¡å™¨éƒ¨ç½²ï¼ˆæ¨èä¸­å°ä¼ä¸šï¼‰
```bash
# é˜¿é‡Œäº‘ECSé…ç½®
- å®ä¾‹è§„æ ¼: ecs.c6.xlarge (4æ ¸8GB)
- æ“ä½œç³»ç»Ÿ: Ubuntu 22.04 LTS
- å¸¦å®½: 10Mbps
- å­˜å‚¨: 100GB SSD
- è´¹ç”¨: çº¦400-600å…ƒ/æœˆ

# æ¶æ„ï¼šå‰ç«¯ + åç«¯ + æ•°æ®åº“åœ¨åŒä¸€å°æœåŠ¡å™¨
```

### æ–¹æ¡ˆäºŒ: åˆ†ç¦»éƒ¨ç½²ï¼ˆæ¨èå¤§å‹ä¼ä¸šï¼‰
```bash
# WebæœåŠ¡å™¨ (å‰ç«¯)
- å®ä¾‹è§„æ ¼: ecs.t6-c1m2.large (2æ ¸4GB)
- è´¹ç”¨: çº¦150-250å…ƒ/æœˆ

# APIæœåŠ¡å™¨ (åç«¯)
- å®ä¾‹è§„æ ¼: ecs.c6.large (2æ ¸4GB)
- è´¹ç”¨: çº¦200-300å…ƒ/æœˆ

# æ•°æ®åº“æœåŠ¡å™¨ (RDS)
- PostgreSQL 15, 2æ ¸4GB
- è´¹ç”¨: çº¦300-500å…ƒ/æœˆ

# æ€»è´¹ç”¨: çº¦650-1050å…ƒ/æœˆ
```

---

## ğŸš€ 2. å•æœåŠ¡å™¨å®Œæ•´éƒ¨ç½²æµç¨‹

### 2.1 æœåŠ¡å™¨åˆå§‹åŒ–
```bash
# è¿æ¥æœåŠ¡å™¨
ssh root@your-server-ip

# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£…åŸºç¡€å·¥å…·
sudo apt install -y curl wget git unzip build-essential software-properties-common nginx postgresql postgresql-contrib redis-server supervisor

# åˆ›å»ºç”¨æˆ·
sudo adduser deploy
sudo usermod -aG sudo deploy
```

### 2.2 ç¯å¢ƒé…ç½®
```bash
# åˆ‡æ¢åˆ°deployç”¨æˆ·
su - deploy

# å®‰è£…Node.js 20
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs

# å®‰è£…Bun
curl -fsSL https://bun.sh/install | bash
source ~/.bashrc

# å®‰è£…Python 3.11
sudo add-apt-repository ppa:deadsnakes/ppa
sudo apt update
sudo apt install -y python3.11 python3.11-venv python3.11-dev
curl https://bootstrap.pypa.io/get-pip.py | python3.11
```

### 2.3 æ•°æ®åº“é…ç½®
```bash
# é…ç½®PostgreSQL
sudo -u postgres psql

-- åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
CREATE DATABASE zhuhai_youmei;
CREATE USER youmei_user WITH PASSWORD 'your_strong_password';
GRANT ALL PRIVILEGES ON DATABASE zhuhai_youmei TO youmei_user;
\q

# é…ç½®Redis
sudo nano /etc/redis/redis.conf
# è®¾ç½®å¯†ç : requirepass your_redis_password
sudo systemctl restart redis-server
```

### 2.4 é¡¹ç›®ç›®å½•ç»“æ„
```bash
# åˆ›å»ºé¡¹ç›®æ€»ç›®å½•
sudo mkdir -p /var/www/zhuhai-youmei
sudo chown -R deploy:deploy /var/www/zhuhai-youmei
cd /var/www/zhuhai-youmei

# ç›®å½•ç»“æ„
/var/www/zhuhai-youmei/
â”œâ”€â”€ frontend/          # Vueå‰ç«¯é¡¹ç›®
â”œâ”€â”€ backend/           # Djangoåç«¯é¡¹ç›®
â”œâ”€â”€ nginx/            # Nginxé…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/          # éƒ¨ç½²è„šæœ¬
â””â”€â”€ logs/            # æ—¥å¿—æ–‡ä»¶
```

---

## ğŸ“¦ 3. åç«¯éƒ¨ç½²

### 3.1 éƒ¨ç½²Djangoé¡¹ç›®
```bash
cd /var/www/zhuhai-youmei

# ä¸‹è½½åç«¯ä»£ç 
git clone https://github.com/your-username/zhuhai-youmei-backend.git backend
cd backend

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.11 -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3.2 Djangoé…ç½®
```bash
# åˆ›å»º.envæ–‡ä»¶
nano .env
```

```env
DEBUG=False
SECRET_KEY=your-very-long-secret-key-here
ALLOWED_HOSTS=your-domain.com,www.your-domain.com,api.your-domain.com

DB_NAME=zhuhai_youmei
DB_USER=youmei_user
DB_PASSWORD=your_strong_password
DB_HOST=localhost
DB_PORT=5432

REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=your_redis_password

CORS_ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com
```

### 3.3 æ•°æ®åº“è¿ç§»
```bash
# æ‰§è¡Œè¿ç§»
python manage.py makemigrations
python manage.py migrate

# åˆ›å»ºè¶…çº§ç”¨æˆ·
python manage.py createsuperuser

# æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput
```

### 3.4 Gunicorné…ç½®
```bash
# å®‰è£…Gunicorn
pip install gunicorn

# åˆ›å»ºGunicorné…ç½®
nano gunicorn.conf.py
```

```python
bind = "127.0.0.1:8000"
workers = 3
worker_class = "sync"
timeout = 30
keepalive = 2
max_requests = 1000
preload_app = True
```

### 3.5 Supervisoré…ç½®
```bash
sudo nano /etc/supervisor/conf.d/zhuhai-youmei-backend.conf
```

```ini
[program:zhuhai-youmei-backend]
command=/var/www/zhuhai-youmei/backend/venv/bin/gunicorn --config gunicorn.conf.py zhuhai_youmei.wsgi:application
directory=/var/www/zhuhai-youmei/backend
user=deploy
autostart=true
autorestart=true
stdout_logfile=/var/www/zhuhai-youmei/logs/backend.log
stderr_logfile=/var/www/zhuhai-youmei/logs/backend_error.log
```

```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p /var/www/zhuhai-youmei/logs

# å¯åŠ¨åç«¯æœåŠ¡
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl start zhuhai-youmei-backend
```

---

## ğŸ¨ 4. å‰ç«¯éƒ¨ç½²

### 4.1 éƒ¨ç½²Vueé¡¹ç›®
```bash
cd /var/www/zhuhai-youmei

# ä¸‹è½½å‰ç«¯ä»£ç 
git clone https://github.com/your-username/zhuhai-youmei-frontend.git frontend
cd frontend

# å®‰è£…ä¾èµ–
bun install
```

### 4.2 é…ç½®APIåœ°å€
```bash
# åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®
nano .env.production
```

```env
VITE_API_BASE_URL=https://api.your-domain.com
VITE_APP_TITLE=ç æµ·ä¼˜ç¾åŒ–å¦†å“æœ‰é™å…¬å¸
```

### 4.3 æ„å»ºå‰ç«¯
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
bun run build

# éªŒè¯æ„å»ºç»“æœ
ls -la dist/
```

---

## ğŸŒ 5. Nginxå®Œæ•´é…ç½®

### 5.1 ä¸»é…ç½®æ–‡ä»¶
```bash
sudo nano /etc/nginx/sites-available/zhuhai-youmei
```

```nginx
# å‰ç«¯ä¸»ç«™
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com www.your-domain.com;

    # SSLé…ç½®
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;

    # å®‰å…¨headers
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header X-Content-Type-Options "nosniff" always;

    # å‰ç«¯é™æ€æ–‡ä»¶
    root /var/www/zhuhai-youmei/frontend/dist;
    index index.html;

    # Vue Router historyæ¨¡å¼
    location / {
        try_files $uri $uri/ /index.html;
    }

    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzipå‹ç¼©
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml;
}

# APIåç«¯
server {
    listen 80;
    server_name api.your-domain.com;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl http2;
    server_name api.your-domain.com;

    # SSLé…ç½®
    ssl_certificate /etc/letsencrypt/live/api.your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/api.your-domain.com/privkey.pem;

    # å®¢æˆ·ç«¯ä¸Šä¼ å¤§å°é™åˆ¶
    client_max_body_size 100M;

    # Djangoé™æ€æ–‡ä»¶
    location /static/ {
        alias /var/www/zhuhai-youmei/backend/staticfiles/;
        expires 1y;
    }

    # Djangoåª’ä½“æ–‡ä»¶
    location /media/ {
        alias /var/www/zhuhai-youmei/backend/media/;
        expires 1y;
    }

    # APIä»£ç†
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # CORS headers (å¦‚æœéœ€è¦)
        add_header Access-Control-Allow-Origin "https://your-domain.com" always;
        add_header Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS" always;
        add_header Access-Control-Allow-Headers "Origin, Content-Type, Accept, Authorization" always;

        if ($request_method = 'OPTIONS') {
            return 204;
        }
    }
}
```

### 5.2 å¯ç”¨é…ç½®
```bash
# å¯ç”¨ç«™ç‚¹
sudo ln -s /etc/nginx/sites-available/zhuhai-youmei /etc/nginx/sites-enabled/
sudo rm /etc/nginx/sites-enabled/default

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

---

## ğŸ”’ 6. SSLè¯ä¹¦é…ç½®

### 6.1 ç”³è¯·è¯ä¹¦
```bash
# å®‰è£…Certbot
sudo apt install -y certbot python3-certbot-nginx

# ä¸ºä¸»åŸŸåç”³è¯·è¯ä¹¦
sudo certbot --nginx -d your-domain.com -d www.your-domain.com

# ä¸ºAPIåŸŸåç”³è¯·è¯ä¹¦
sudo certbot --nginx -d api.your-domain.com

# è®¾ç½®è‡ªåŠ¨ç»­æœŸ
echo "0 2 1 * * /usr/bin/certbot renew --quiet && /usr/bin/systemctl reload nginx" | sudo crontab -
```

---

## ğŸ”„ 7. è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

### 7.1 å®Œæ•´éƒ¨ç½²è„šæœ¬
```bash
nano /var/www/zhuhai-youmei/scripts/deploy.sh
```

```bash
#!/bin/bash

echo "ğŸš€ å¼€å§‹éƒ¨ç½²ç æµ·ä¼˜ç¾å®˜ç½‘..."

PROJECT_ROOT="/var/www/zhuhai-youmei"
BACKEND_DIR="$PROJECT_ROOT/backend"
FRONTEND_DIR="$PROJECT_ROOT/frontend"

# æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°
cd $PROJECT_ROOT

echo "ğŸ“¦ æ›´æ–°åç«¯ä»£ç ..."
cd $BACKEND_DIR
git pull origin main

echo "ğŸ“¦ æ›´æ–°å‰ç«¯ä»£ç ..."
cd $FRONTEND_DIR
git pull origin main

# åç«¯éƒ¨ç½²
echo "ğŸ”§ éƒ¨ç½²åç«¯..."
cd $BACKEND_DIR
source venv/bin/activate
pip install -r requirements.txt
python manage.py migrate
python manage.py collectstatic --noinput
sudo supervisorctl restart zhuhai-youmei-backend

# å‰ç«¯éƒ¨ç½²
echo "ğŸ¨ éƒ¨ç½²å‰ç«¯..."
cd $FRONTEND_DIR
bun install
bun run build

# é‡å¯æœåŠ¡
echo "ğŸ”„ é‡å¯æœåŠ¡..."
sudo systemctl reload nginx

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
echo "âœ… æ£€æŸ¥æœåŠ¡çŠ¶æ€..."
sudo supervisorctl status zhuhai-youmei-backend
sudo systemctl status nginx

echo "ğŸ‰ éƒ¨ç½²å®Œæˆï¼"
echo "ğŸŒ å‰ç«¯åœ°å€: https://your-domain.com"
echo "ğŸ”— APIåœ°å€: https://api.your-domain.com"
echo "âš™ï¸ ç®¡ç†åå°: https://api.your-domain.com/admin/"
```

```bash
chmod +x /var/www/zhuhai-youmei/scripts/deploy.sh
```

### 7.2 å¿«é€Ÿé‡å¯è„šæœ¬
```bash
nano /var/www/zhuhai-youmei/scripts/restart.sh
```

```bash
#!/bin/bash

echo "ğŸ”„ é‡å¯æ‰€æœ‰æœåŠ¡..."

# é‡å¯åç«¯
sudo supervisorctl restart zhuhai-youmei-backend

# é‡å¯Nginx
sudo systemctl restart nginx

# é‡å¯æ•°æ®åº“å’Œç¼“å­˜
sudo systemctl restart postgresql
sudo systemctl restart redis-server

echo "âœ… æ‰€æœ‰æœåŠ¡å·²é‡å¯"
```

---

## ğŸ“Š 8. ç›‘æ§å’Œæ—¥å¿—

### 8.1 æ—¥å¿—èšåˆè„šæœ¬
```bash
nano /var/www/zhuhai-youmei/scripts/logs.sh
```

```bash
#!/bin/bash

case "$1" in
    backend)
        tail -f /var/www/zhuhai-youmei/logs/backend.log
        ;;
    backend-error)
        tail -f /var/www/zhuhai-youmei/logs/backend_error.log
        ;;
    nginx-access)
        sudo tail -f /var/log/nginx/access.log
        ;;
    nginx-error)
        sudo tail -f /var/log/nginx/error.log
        ;;
    postgres)
        sudo tail -f /var/log/postgresql/postgresql-15-main.log
        ;;
    all)
        echo "=== Backend Logs ==="
        tail -n 20 /var/www/zhuhai-youmei/logs/backend.log
        echo -e "\n=== Nginx Logs ==="
        sudo tail -n 20 /var/log/nginx/error.log
        ;;
    *)
        echo "Usage: $0 {backend|backend-error|nginx-access|nginx-error|postgres|all}"
        ;;
esac
```

### 8.2 ç³»ç»Ÿç›‘æ§è„šæœ¬
```bash
nano /var/www/zhuhai-youmei/scripts/monitor.sh
```

```bash
#!/bin/bash

echo "ğŸ“Š ç³»ç»ŸçŠ¶æ€ç›‘æ§"
echo "=================="

# ç³»ç»Ÿèµ„æº
echo "ğŸ’¾ å†…å­˜ä½¿ç”¨:"
free -h

echo -e "\nğŸ’½ ç£ç›˜ä½¿ç”¨:"
df -h

echo -e "\nğŸ”¥ CPUä½¿ç”¨:"
top -b -n1 | grep "Cpu(s)"

# æœåŠ¡çŠ¶æ€
echo -e "\nğŸš€ æœåŠ¡çŠ¶æ€:"
echo "Nginx: $(sudo systemctl is-active nginx)"
echo "PostgreSQL: $(sudo systemctl is-active postgresql)"
echo "Redis: $(sudo systemctl is-active redis-server)"
echo "Backend: $(sudo supervisorctl status zhuhai-youmei-backend | awk '{print $2}')"

# ç«¯å£ç›‘å¬
echo -e "\nğŸŒ ç«¯å£ç›‘å¬:"
sudo netstat -tlnp | grep -E ':80|:443|:8000|:5432|:6379'

# æœ€è¿‘æ—¥å¿—
echo -e "\nğŸ“ æœ€è¿‘é”™è¯¯ (æœ€è¿‘10æ¡):"
sudo tail -n 10 /var/log/nginx/error.log | grep -E "error|warn" || echo "æ— é”™è¯¯æ—¥å¿—"
```

---

## ğŸ”§ 9. å¤‡ä»½ç­–ç•¥

### 9.1 å®Œæ•´å¤‡ä»½è„šæœ¬
```bash
nano /var/www/zhuhai-youmei/scripts/backup.sh
```

```bash
#!/bin/bash

BACKUP_DIR="/home/deploy/backups"
DATE=$(date +%Y%m%d_%H%M%S)
PROJECT_ROOT="/var/www/zhuhai-youmei"

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# æ•°æ®åº“å¤‡ä»½
echo "ğŸ—„ï¸ å¤‡ä»½æ•°æ®åº“..."
pg_dump -h localhost -U youmei_user -d zhuhai_youmei > $BACKUP_DIR/db_backup_$DATE.sql

# åª’ä½“æ–‡ä»¶å¤‡ä»½
echo "ğŸ“ å¤‡ä»½åª’ä½“æ–‡ä»¶..."
tar -czf $BACKUP_DIR/media_backup_$DATE.tar.gz -C $PROJECT_ROOT/backend media/

# é…ç½®æ–‡ä»¶å¤‡ä»½
echo "âš™ï¸ å¤‡ä»½é…ç½®æ–‡ä»¶..."
tar -czf $BACKUP_DIR/config_backup_$DATE.tar.gz -C / etc/nginx/sites-available/zhuhai-youmei etc/supervisor/conf.d/zhuhai-youmei-backend.conf $PROJECT_ROOT/backend/.env

# ä»£ç å¤‡ä»½ (å¯é€‰)
echo "ğŸ’¾ å¤‡ä»½ä»£ç ..."
tar -czf $BACKUP_DIR/code_backup_$DATE.tar.gz --exclude='*/node_modules' --exclude='*/venv' --exclude='*/dist' -C /var/www zhuhai-youmei

# æ¸…ç†æ—§å¤‡ä»½ (ä¿ç•™7å¤©)
find $BACKUP_DIR -name "*backup_*" -mtime +7 -delete

echo "âœ… å¤‡ä»½å®Œæˆåˆ°: $BACKUP_DIR"
echo "ğŸ“ æ•°æ®åº“: db_backup_$DATE.sql"
echo "ğŸ“ åª’ä½“æ–‡ä»¶: media_backup_$DATE.tar.gz"
echo "ğŸ“ é…ç½®æ–‡ä»¶: config_backup_$DATE.tar.gz"
echo "ğŸ“ ä»£ç : code_backup_$DATE.tar.gz"
```

### 9.2 è®¾ç½®å®šæœŸå¤‡ä»½
```bash
# è®¾ç½®æ¯æ—¥å‡Œæ™¨2ç‚¹å¤‡ä»½
crontab -e
# æ·»åŠ ï¼š0 2 * * * /var/www/zhuhai-youmei/scripts/backup.sh
```

---

## ğŸ” 10. å®‰å…¨é…ç½®

### 10.1 é˜²ç«å¢™é…ç½®
```bash
# é…ç½®UFW
sudo ufw allow ssh
sudo ufw allow 'Nginx Full'
sudo ufw deny 8000  # ç¦æ­¢ç›´æ¥è®¿é—®Djangoç«¯å£
sudo ufw deny 5432  # ç¦æ­¢å¤–éƒ¨è®¿é—®æ•°æ®åº“
sudo ufw enable

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status verbose
```

### 10.2 Fail2bané…ç½®
```bash
# å®‰è£…Fail2ban
sudo apt install -y fail2ban

# é…ç½®
sudo nano /etc/fail2ban/jail.local
```

```ini
[DEFAULT]
bantime = 3600
findtime = 600
maxretry = 3

[sshd]
enabled = true

[nginx-http-auth]
enabled = true

[nginx-limit-req]
enabled = true
```

---

## ğŸ“‹ 11. ç»´æŠ¤æ¸…å•

### 11.1 æ¯æ—¥æ£€æŸ¥
```bash
# è¿è¡Œç›‘æ§è„šæœ¬
/var/www/zhuhai-youmei/scripts/monitor.sh

# æ£€æŸ¥å¤‡ä»½
ls -la /home/deploy/backups/

# æ£€æŸ¥æ—¥å¿—
/var/www/zhuhai-youmei/scripts/logs.sh all
```

### 11.2 æ¯å‘¨ç»´æŠ¤
```bash
# ç³»ç»Ÿæ›´æ–°
sudo apt update && sudo apt upgrade -y

# æ¸…ç†æ—¥å¿—
sudo journalctl --vacuum-time=7d

# æ¸…ç†å¤‡ä»½
find /home/deploy/backups -mtime +30 -delete
```

### 11.3 æ¯æœˆç»´æŠ¤
```bash
# æ›´æ–°SSLè¯ä¹¦
sudo certbot renew

# æ•°æ®åº“ç»´æŠ¤
sudo -u postgres psql -d zhuhai_youmei -c "VACUUM ANALYZE;"

# æ£€æŸ¥ç£ç›˜ä½¿ç”¨
df -h
```

---

## ğŸš€ 12. æ€§èƒ½ä¼˜åŒ–

### 12.1 æ•°æ®åº“ä¼˜åŒ–
```sql
-- PostgreSQLä¼˜åŒ–é…ç½®
-- ç¼–è¾‘ /etc/postgresql/15/main/postgresql.conf

shared_buffers = 256MB
effective_cache_size = 1GB
maintenance_work_mem = 64MB
checkpoint_completion_target = 0.9
wal_buffers = 16MB
default_statistics_target = 100
```

### 12.2 Nginxä¼˜åŒ–
```nginx
# ç¼–è¾‘ /etc/nginx/nginx.conf

worker_processes auto;
worker_connections 1024;
keepalive_timeout 65;

# å¯ç”¨HTTP/2
server {
    listen 443 ssl http2;
    # ...
}
```

---

## ğŸ“ 13. æ•…éšœæ’é™¤

### 13.1 å¸¸è§é—®é¢˜
```bash
# ç½‘ç«™æ— æ³•è®¿é—®
sudo systemctl status nginx
sudo nginx -t

# APIä¸å“åº”
sudo supervisorctl status zhuhai-youmei-backend
tail -f /var/www/zhuhai-youmei/logs/backend_error.log

# æ•°æ®åº“è¿æ¥é”™è¯¯
sudo systemctl status postgresql
sudo -u postgres psql -l

# SSLè¯ä¹¦é—®é¢˜
sudo certbot certificates
sudo nginx -t
```

### 13.2 åº”æ€¥æ¢å¤
```bash
# å¿«é€Ÿå›æ»š
git log --oneline -10  # æŸ¥çœ‹æäº¤å†å²
git checkout <commit-hash>  # å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬
/var/www/zhuhai-youmei/scripts/deploy.sh

# æ•°æ®åº“æ¢å¤
sudo -u postgres psql -d zhuhai_youmei < backup.sql
```

---

## ğŸ‰ éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

### âœ… å‰ç«¯æ£€æŸ¥
- [ ] https://your-domain.com å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰é¡µé¢è·¯ç”±æ­£å¸¸å·¥ä½œ
- [ ] å“åº”å¼è®¾è®¡åœ¨å„è®¾å¤‡æ­£å¸¸æ˜¾ç¤º
- [ ] é™æ€èµ„æºåŠ è½½æ­£å¸¸

### âœ… åç«¯æ£€æŸ¥
- [ ] https://api.your-domain.com/admin/ ç®¡ç†åå°å¯è®¿é—®
- [ ] APIæ¥å£è¿”å›æ­£ç¡®æ•°æ®
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸

### âœ… ç³»ç»Ÿæ£€æŸ¥
- [ ] SSLè¯ä¹¦æœ‰æ•ˆä¸”è‡ªåŠ¨ç»­æœŸè®¾ç½®å®Œæˆ
- [ ] é˜²ç«å¢™è§„åˆ™é…ç½®æ­£ç¡®
- [ ] å¤‡ä»½è„šæœ¬è¿è¡Œæ­£å¸¸
- [ ] ç›‘æ§è„šæœ¬å¯ä»¥æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

---

ğŸ‰ **æ­å–œï¼ç æµ·ä¼˜ç¾åŒ–å¦†å“å®˜ç½‘å·²å®Œæ•´éƒ¨ç½²æˆåŠŸï¼**

**è®¿é—®åœ°å€:**
- ğŸŒ å®˜ç½‘é¦–é¡µ: https://your-domain.com
- ğŸ”— APIæ¥å£: https://api.your-domain.com
- âš™ï¸ ç®¡ç†åå°: https://api.your-domain.com/admin/

**ç®¡ç†å‘½ä»¤:**
- éƒ¨ç½²æ›´æ–°: `/var/www/zhuhai-youmei/scripts/deploy.sh`
- é‡å¯æœåŠ¡: `/var/www/zhuhai-youmei/scripts/restart.sh`
- æŸ¥çœ‹æ—¥å¿—: `/var/www/zhuhai-youmei/scripts/logs.sh all`
- ç³»ç»Ÿç›‘æ§: `/var/www/zhuhai-youmei/scripts/monitor.sh`
- æ•°æ®å¤‡ä»½: `/var/www/zhuhai-youmei/scripts/backup.sh`
